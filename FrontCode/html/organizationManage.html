<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>智能锁管理平台</title>
    <style type="text/css">
        .screen-top{
            padding:8px 0;
            background-color:#f6f6f6;
        }
        .screen-top span{
            width: 100px !important;
            text-align: center !important;
            font-size:16px;
            padding-left:15px;
            margin-bottom: 3px;
        }
        .screen-top span input{
            margin-left: 20px;
            padding: 6px;
            font-size: 13px;
            height: 17px;
            /*background: #fff url('../assets/images/bg-form-field.gif') top left repeat-x;*/
            border: 1px solid #d5d5d5;
            color: #333;
            width: 15% !important;
        }

        .popBox .txtBox
        {
            margin: 20px 50px;
            height: 360px;
            overflow: auto;
        }
    </style>
    <!--CSS-->
    <script type="text/javascript" src="../assets/js/jquery-1.8.0.min.js"></script>
    <!-- Reset Stylesheet -->
    <link rel="stylesheet" href="../assets/css/reset.css" type="text/css" media="screen" />
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="../assets/css/style.css" type="text/css" media="screen" />
    <!-- dialog Stylesheet -->
    <link href="../assets/css/dialog.css" rel="stylesheet" type="text/css"/>
    <!-- Invalid Stylesheet. This makes stuff look pretty. Remove it if you want the CSS completely valid -->
    <link rel="stylesheet" href="../assets/css/invalid.css" type="text/css" media="screen" />
    <!-- Colour Schemes  -->
    <!--Default colour scheme is green. Uncomment prefered stylesheet to use it.-->
    <!--<link rel="stylesheet" href="../assets/css/blue.css" type="text/css" media="screen" />-->
    <!--<link rel="stylesheet" href="../assets/css/red.css" type="text/ css" media="screen" />-->
    <!-- Internet Explorer Fixes Stylesheet -->
    <!--[if lte IE 7]>
    <link rel="stylesheet" href="../assets/css/ie.css" type="text/css" media="screen" />
    <![endif]-->
    <!--Javascripts-->
    <!--JqueryDateTable-->
    <link rel="stylesheet" href="../assets/css/jquery.dataTables.min.css"/>
    <script type="text/javascript" src="../assets/js/jquery.dataTables.min.js"></script>
    <!-- jQuery -->
    <!--时间插件-->
    <script type="text/javascript" src="../assets/js/laydate.js"></script>
    <!-- jQuery Configuration -->

    <script type="text/javascript" src="../assets/js/My97DatePicker/WdatePicker.js"></script>
    <script type="text/javascript" src="../assets/js/simpla.jquery.configuration.js"></script>
    <!--[if IE]><script type="text/javascript" src="../assets/js/jquery.bgiframe.js"></script><![endif]-->
    <!-- Internet Explorer .png-fix -->
    <!--[if IE 6]>
    <script type="text/javascript" src="../assets/js/DD_belatedPNG_0.0.7a.js"></script>
    <script type="text/javascript">
        DD_belatedPNG.fix('.png_bg, img, li');
    </script>
    <![endif]-->
    <!--编辑框开始-->
    <!--主要对本页面的样式进行重新设置-->

    <script type="text/javascript">
        //显示条目编辑框
        $(document).ready(function() {
            $(".clsBtn[title=oneOrganizationInfo]").click(function(event) {
                $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").hide();
            });
            $(".model").click(function(event) {
                $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").show();
            });

            $("#cancel_eidtOrganization").click(function(event) {
                $(".popBox[title=oneOrganizationInfo] input").val("");
                $(".popBox[title=oneOrganizationInfo] textarea").val("");
                $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").hide();
                $("#submit_editOrganization").show();
                $("#reject_editOrganization").show();
                $(".popBox[title=oneOrganizationInfo] input").attr("disabled",false);
                $(".popBox[title=oneOrganizationInfo] textarea").removeAttr("disabled");
            });
        });
        //个人资料编辑框控制
        $(document).ready(function(){
            $("#cancel_editPerson").click(function(event) {
                $(".popBox[title=editPersonInfo] input").val("");
                $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").hide();
            });
            $(".clsBtn[title=editPersonInfo]").click(function(event) {
                $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").hide();
            });
        });
        //个人资料编辑交互方法控制
        $(document).ready(function(){
            /**
             * 点击修改个人资料
             */
            $(".mode2").click(function(){
                //获取原始数据
                var username = userInfo.username;
                var userType = userInfo.userType;
                var company = userInfo.company;
                var phone = userInfo.phone;
                //将数据预填入编辑框
                $("#editPerson_username").val(username);
                var displayUserType="";
                if(userType!=""||userType!=null){
                    switch(userType[0]){
                        case "1":
                            displayUserType="铁塔公司";
                            switch (userType[1]){
                                case "0":
                                    displayUserType+="省级";
                                    break;
                                case "1":
                                    displayUserType+="市级"
                                    break;
                                case "2":
                                    displayUserType+="县区级";
                                    break;
                            }
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "2":
                            displayUserType="运营商";
                            switch (userType[1]){
                                case "0":
                                    displayUserType+="省级";
                                    break;
                                case "1":
                                    displayUserType+="市级"
                                    break;
                                case "2":
                                    displayUserType+="县区级";
                                    break;
                            }
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "3":
                            displayUserType="施工公司";
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "4":
                            displayUserType="代维公司";
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                        case "5":
                            displayUserType="厂商";
                            switch (userType[2]){
                                case "1":
                                    displayUserType+="管理员";
                                    break;
                                case "2":
                                    displayUserType+="审批员";
                                    break;
                                case "3":
                                    displayUserType+="工程师";
                                    break;
                            }
                            break;
                    }

                }
                if (displayUserType!=""){
                    $("#editPerson_userType").val(displayUserType);
                }
                $("#editPerson_company").val(company);
                $("#editPerson_phone").val(phone);
                $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").show();
            });
            /**
             * 修改个人资料，提交
             */
            $("#submit_editPerson").click(function(){
                //获取公共字段
                var originalPhone = userInfo.phone;
                var originalPassword = localStorage.getItem("originalPassword");
                var operatorName=userInfo.username;
                var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&originalName="+operatorName;
                var updatePersonInfo = "";
                //获取编辑数据
//                var phone = $("#editPerson_phone").val();
                var password = $("#editPerson_originalPassword").val();
                var newPassword1 = $("#editPerson_newPassword1").val();
                var newPassword2 = $("#editPerson_newPassword2").val();
                if(password!=originalPassword){
                    alert("原始密码不正确，请重新输入！");
                    $("#editPerson_originalPassword").val("");
                    $("#editPerson_originalPassword").focus();
                    return;
                }else if(newPassword1==""||newPassword2==""){
                    $("#editPerson_newPassword1").focus();
                    alert("输入参数为空，请重新输入！");
                    return;
                }else if(newPassword1!=newPassword2){
                    alert("两次输入密码不一致，请重新输入！");
                    $("#editPerson_newPassword1").val("");
                    $("#editPerson_newPassword2").val("");
                    $("#editPerson_newPassword1").focus();
                    return;
                }else{
                    updatePersonInfo+="&password="+newPassword1;
                }
                if(updatePersonInfo==""){
                    alert("输入参数为空，请重新输入！");
                    $("#editPerson_newPassword1").focus();
                    return;
                }else{
                    qsData+=updatePersonInfo;
                }
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/updateUser",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);
                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            }
                        }else if (infoJson.success)
                        {
                            var sucInfo =  infoJson.success;
                            var msg = sucInfo.msg;
                            alert(msg);
                            $(".popBox[title=editPersonInfo] input").val("");
                            $(".model-bg[title=editPersonInfo],.popBox[title=editPersonInfo]").hide();
                            if(sucInfo.code=="04000"){
                                window.location.href="login.html";
                            }
                        }else {
                            alert("未知错误，请联系管理员！")
                        }
                    },
                    error: function (result) {
                        console.log(result);
                        alert("无法连接到服务器！");
                    }
                });
            });
        });
    </script>
    <!--编辑框结束-->
    <script type="text/javascript">
        var tabContent ="#queryApplyTable";  //全局定义变量
        var queryApplyTable ;
        var table ;
        var pendingTaskListTable ;
        var rejectTaskListTable ;
        var approvedTaskListTable ;
        var userInfo=JSON.parse(localStorage.getItem("userInfo"));
        var tokenEndTime=localStorage.getItem("tokenEndTime");
        var originalKeyID = "";
        var originalID = "";
        var isUpdate=0;
        //设置时间格式
        Date.prototype.format = function(format) {
            var date = {
                "M+": this.getMonth() + 1,
                "d+": this.getDate(),
                "h+": this.getHours(),
                "m+": this.getMinutes(),
                "s+": this.getSeconds(),
                "q+": Math.floor((this.getMonth() + 3) / 3),
                "S+": this.getMilliseconds()
            };
            if (/(y+)/i.test(format)) {
                format = format.replace(RegExp.$1, (this.getFullYear() + '').substr(4 - RegExp.$1.length));
            }
            for (var k in date) {
                if (new RegExp("(" + k + ")").test(format)) {
                    format = format.replace(RegExp.$1, RegExp.$1.length == 1
                            ? date[k] : ("00" + date[k]).substr(("" + date[k]).length));
                }
            }
            return format;
        };













        /**
         * datables初始化
         */
        $(document).ready(function() {
            //初始化全部展示框
            queryApplyTable = $('#queryApplyTable').DataTable( {
                "searching": false,
                "bStateSave": false,
                "aoColumns": [
                    {
                        "data":"_id",
                        "orderable": false,
                        "render": function(data, type, full, meta) {
                            return data = '<input type="checkbox" id="checkbox" value="'+data+'" title="'+data+'"/>';

                        }
                    },
                    {
                        "data": "applyCompanyID",
                        "sClass" : "center"
                    },
                    { "data": "applyCompany" },
                    { "data": "applyPersonID"},
                    { "data": "applyPerson"},
                    { "data": "applyTime",
                       "render": function(data, type, full, meta)
                       {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        },
                        "sWidth":"12%"
                    },
                    { "data": "applyContent"},
                    { "data": "approveCompanyID"},
                    { "data": "approveCompany"},
                    { "data": "approvePersonID"},
                    { "data": "approvePerson" },
                    { "data": "approveTime",
                        "render": function(data, type, full, meta)
                        {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        },
                        "sWidth":"12%"
                    },
                    {
                        "data": "approveResult",
                        "render": function(data, type, full, meta)
                        {

                            if (data == "审核中") {
                                return "<font color='red'>审核中</font>";
                            }
                            else if (data == "拒绝") {
                                return "<font color='red'>拒绝</font>";
                            }
                            else if (data == "同意") {
                                return "<font color='green'>同意</font>";
                            }
                        }
                    },
                    {
                        "data":null,
                        "render": function(data, type, row, meta) {
                            if (row.approveResult=="审核中"){
                                return data = '<a href="#" id="editOne" title="edit" class="model_pending" onclick="processTask()">' +
                                        ' <img src="../assets/images/icons/hammer_screwdriver.png" alt="edit" /></a>';
                            }else {
                                return data = '<a href="#" id="logInfo" title="logInfo" class="model_log" onclick="showLog()"><img src="../assets/images/icons/text.png" alt="logInfo"/></a>';
                            }
                        }
                    }
                ],
                language: {
                    "sProcessing": "处理中...",
                    "sLengthMenu": "显示 _MENU_ 项结果",
                    "sZeroRecords": "没有匹配结果",
                    "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索:",
                    "sUrl": "",
                    "sEmptyTable": "表中数据为空",
                    "sLoadingRecords": "载入中...",
                    "sInfoThousands": ",",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上页",
                        "sNext": "下页",
                        "sLast": "末页"
                    },
                    "oAria": {
                        "sSortAscending": ": 以升序排列此列",
                        "sSortDescending": ": 以降序排列此列"
                    }
                },
//               initComplete: initComplete
            });
            table = queryApplyTable;
            //初始化待处理展示框
            pendingTaskListTable = $('#pendingTaskListTable').DataTable( {
                "searching": false,
                "bStateSave": false,
                "aoColumns": [
                    {
                        "data":"_id",
                        "orderable": false,
                        "render": function(data, type, full, meta) {
                            return data = '<input type="checkbox" id="checkbox" value="'+data+'" title="'+data+'"/>';

                        }
                    },
                    {
                        "data": "taskID",
                        "sClass" : "center"
                    },
                    { "data": "stationAddress" },
                    {
                        "data": "taskStartTime",
                        "render": function(data, type, full, meta) {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        }
                    },
                    {
                        "data":"taskEndTime",
                        "render": function(data, type, full, meta) {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        }
                    },
                    { "data": "applyDescription" },
                    { "data": "applicationType",
                        "render": function(data, type, full, meta) {

                            if(data=="普通")
                            {
                                return "<font color='green'>普通</font>";
                            }
                            else if(data=="紧急")
                            {
                                return "<font color='red'>紧急</font>";
                            }

                        }

                    },
                    { "data": "applicantName" },
                    {
                        "data": function(obj){
                            return obj.stationManagementProvince + obj.stationManagementCity+obj.stationManagementArea;
                        }
                    },
                    {
                        "data":"applicationStatus",
                        "render": function(data, type, full, meta) {

                            if(data=="approve")
                            {
                                return "<font color='green'>同意</font>";
                            }
                            else if(data=="reject")
                            {
                                return "<font color='red'>拒绝</font>";
                            }
                            else if(data=="pending")
                            {
                                return "<font color='red'>待批准</font>";
                            }

                        }
                    },{
                        "data":"_id",
                        "render": function(data, type, full, meta) {
                            return data = '<a href="#" id="editOne" title="edit" class="model_pending" onclick="processTask()"><img src="../assets/images/icons/hammer_screwdriver.png" alt="edit" /></a>';

                        }
                    }
                ],
                language: {
                    "sProcessing": "处理中...",
                    "sLengthMenu": "显示 _MENU_ 项结果",
                    "sZeroRecords": "没有匹配结果",
                    "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索:",
                    "sUrl": "",
                    "sEmptyTable": "表中数据为空",
                    "sLoadingRecords": "载入中...",
                    "sInfoThousands": ",",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上页",
                        "sNext": "下页",
                        "sLast": "末页"
                    },
                    "oAria": {
                        "sSortAscending": ": 以升序排列此列",
                        "sSortDescending": ": 以降序排列此列"
                    }
                },
//               initComplete: initComplete
            });
            //初始化拒绝展示框
            rejectTaskListTable = $('#rejectTaskListTable').DataTable( {
                "searching": false,
                "bStateSave": false,
                "aoColumns": [
                    {
                        "data": "taskID",
                        "sClass" : "center"
                    },
                    { "data": "stationAddress" },
                    {
                        "data": "taskStartTime",
                        "render": function(data, type, full, meta) {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        }
                    },
                    {
                        "data":"taskEndTime",
                        "render": function(data, type, full, meta) {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        }
                    },
                    { "data": "applyDescription" },
                    { "data": "applicationType",
                        "render": function(data, type, full, meta) {

                            if(data=="普通")
                            {
                                return "<font color='green'>普通</font>";
                            }
                            else if(data=="紧急")
                            {
                                return "<font color='red'>紧急</font>";
                            }

                        }


                    },
                    { "data": "applicantName" },
                    {
                        "data": function(obj){
                            return obj.stationManagementProvince + obj.stationManagementCity+obj.stationManagementArea;
                        }
                    },
                    {
                        "data":"applicationStatus",
                        "render": function(data, type, full, meta) {

                            if(data=="approve")
                            {
                                return "<font color='green'>同意</font>";
                            }
                            else if(data=="reject")
                            {
                                return "<font color='red'>拒绝</font>";
                            }
                            else if(data=="pending")
                            {
                                return "<font color='red'>待批准</font>";
                            }

                        }

                    },{
                        "data":"_id",
                        "render": function(data, type, full, meta) {
                            return data = '<a href="#" id="logInfo" title="logInfo" class="model_log" onclick="showLog()"><img src="../assets/images/icons/text.png" alt="logInfo"/></a>';
                        }
                    }
                ],
                language: {
                    "sProcessing": "处理中...",
                    "sLengthMenu": "显示 _MENU_ 项结果",
                    "sZeroRecords": "没有匹配结果",
                    "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索:",
                    "sUrl": "",
                    "sEmptyTable": "表中数据为空",
                    "sLoadingRecords": "载入中...",
                    "sInfoThousands": ",",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上页",
                        "sNext": "下页",
                        "sLast": "末页"
                    },
                    "oAria": {
                        "sSortAscending": ": 以升序排列此列",
                        "sSortDescending": ": 以降序排列此列"
                    }
                },
//               initComplete: initComplete
            });
            //初始化同意展示框
            approvedTaskListTable = $('#approvedTaskListTable').DataTable( {
                "searching": false,
                "bStateSave": false,
                "aoColumns": [
                    {
                        "data": "taskID",
                        "sClass" : "center"
                    },
                    { "data": "stationAddress" },
                    {
                        "data": "taskStartTime",
                        "render": function(data, type, full, meta) {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        }
                    },
                    {
                        "data":"taskEndTime",
                        "render": function(data, type, full, meta) {
                            data = new Date(parseInt(data) * 1000).format('yyyy/MM/dd h:m:s');
                            return data;
                        }
                    },
                    { "data": "applyDescription" },
                    { "data": "applicationType",
                        "render": function(data, type, full, meta) {

                            if(data=="普通")
                            {
                                return "<font color='green'>普通</font>";
                            }
                            else if(data=="紧急")
                            {
                                return "<font color='red'>紧急</font>";
                            }

                        }

                    },
                    { "data": "applicantName" },
                    {
                        "data": function(obj){
                            return obj.stationManagementProvince + obj.stationManagementCity+obj.stationManagementArea;
                        }
                    },
                    {
                        "data":"applicationStatus",
                        "render": function(data, type, full, meta) {

                            if(data=="approve")
                            {
                                return "<font color='green'>同意</font>";
                            }
                            else if(data=="reject")
                            {
                                return "<font color='red'>拒绝</font>";
                            }
                            else if(data=="pending")
                            {
                                return "<font color='red'>待批准</font>";
                            }

                        }

                    },{
                        "data":"_id",
                        "render": function(data, type, full, meta) {
                            return data = '<a href="#" id="logInfo" title="logInfo" class="model_log" onclick="showLog()"><img src="../assets/images/icons/text.png" alt="logInfo"/></a>';

                        }
                    }
                ],
                language: {
                    "sProcessing": "处理中...",
                    "sLengthMenu": "显示 _MENU_ 项结果",
                    "sZeroRecords": "没有匹配结果",
                    "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                    "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                    "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                    "sInfoPostFix": "",
                    "sSearch": "搜索:",
                    "sUrl": "",
                    "sEmptyTable": "表中数据为空",
                    "sLoadingRecords": "载入中...",
                    "sInfoThousands": ",",
                    "oPaginate": {
                        "sFirst": "首页",
                        "sPrevious": "上页",
                        "sNext": "下页",
                        "sLast": "末页"
                    },
                    "oAria": {
                        "sSortAscending": ": 以升序排列此列",
                        "sSortDescending": ": 以降序排列此列"
                    }
                },
//               initComplete: initComplete
            })
        } );
        /**
         * 显示工单详细信息
         */
        function  showLog(){
            $(""+tabContent+"").on( 'click', '.model_log', function () {
                var trInfo = table.row( this.parentNode).data();
//                window.console.log(trInfo);
                //获取字段值对弹出框进行内容进行填充

                $("#edit_applyCompanyID").val(trInfo.applyCompanyID);
                $("#edit_applyCompany").val(trInfo.applyCompany);
                $("#edit_applyPersonID").val(trInfo.applyPersonID);
                $("#edit_applyPerson").val(trInfo.applyPerson);
                $("#edit_applyTime").val( new Date(parseInt(trInfo.applyTime) * 1000).format('yyyy/MM/dd h:m:s') );
                $("#edit_applyContent").val(trInfo.applyContent);
                $("#edit_approveCompanyID").val(trInfo.approveCompanyID);
                $("#edit_approveCompany").val(trInfo.approveCompany);
                $("#edit_approvePersonID").val(trInfo.approvePersonID);
                $("#edit_approvePerson").val(trInfo.approvePerson);
                $("#edit_approveTime").val( new Date(parseInt(trInfo.approveTime) * 1000).format('yyyy/MM/dd h:m:s') );
                if(trInfo.approveResult=="审核中")
                {
                    $("#edit_approveResult").get(0).selectedIndex = 0;
                }
                else if(trInfo.approveResult=="拒绝")
                {
                    $("#edit_approveResult").get(0).selectedIndex = 1;

                }
                else if(trInfo.approveResult=="同意")
                {
                    $("#edit_approveResult").get(0).selectedIndex = 2;

                }


                $(".popBox[title=oneOrganizationInfo] input").attr("disabled",true);
                $(".popBox[title=oneOrganizationInfo] select").attr("disabled",true);
                $(".popBox[title=oneOrganizationInfo] textarea").attr("disabled","disabled");

                //显示审批窗口
                $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").show();
                $("#submit_editOrganization").hide();
                $("#reject_editOrganization").hide();
            } );
        };
        /**
         * 处理工单
         */
        function processTask()
        {
            $(""+tabContent+"").on( 'click', '.model_pending', function () {
                var trInfo = table.row(this.parentNode).data();
                originalID=trInfo._id;
//
//
//  window.console.log(trInfo);

                //获取字段值对弹出框进行内容进行填充
                $("#edit_applyCompanyID").val(trInfo.applyCompanyID);
                $("#edit_applyCompany").val(trInfo.applyCompany);
                $("#edit_applyPersonID").val(trInfo.applyPersonID);
                $("#edit_applyPerson").val(trInfo.applyPerson);
                $("#edit_applyTime").val( new Date(parseInt(trInfo.applyTime) * 1000).format('yyyy/MM/dd h:m:s') );
                $("#edit_applyContent").val(trInfo.applyContent);
                $("#edit_approveCompanyID").val(trInfo.approveCompanyID);
                $("#edit_approveCompany").val(trInfo.approveCompany);
                $("#edit_approvePersonID").val(trInfo.approvePersonID);
                $("#edit_approvePerson").val(trInfo.approvePerson);
                $("#edit_approveTime").val( new Date(parseInt(trInfo.approveTime) * 1000).format('yyyy/MM/dd h:m:s') );
                if(trInfo.approveResult=="审核中")
                {
                    $("#edit_approveResult").get(0).selectedIndex = 0;
                }
                else if(trInfo.approveResult=="拒绝")
                {
                    $("#edit_approveResult").get(0).selectedIndex = 1;

                }
                else if(trInfo.approveResult=="同意")
                {
                    $("#edit_approveResult").get(0).selectedIndex = 2;

                }
//                $("#edit_approveResult").val(trInfo.approveResult);
//                $("#edit_taskStartTime").val( );
//                $("#edit_taskEndTime").val();
//                $("#edit_taskTimes").val(trInfo.taskTimes);

                $("#reject_editOrganization").show();

                $(".popBox[title=oneOrganizationInfo] input").attr("disabled",true);
                $(".popBox[title=oneOrganizationInfo] select").attr("disabled",true);
                //显示审批窗口
                $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").show();
            } );
        };
        /**
         * 按钮点击功能
         */
        $(document).ready(function(){
            //Tab页面加载方式
            $('.content-box ul.content-box-tabs li a').click(function() {
                        var currentTab = $(this).attr('href');
//                        window.console.log("当前点击的Tab名称为：在页面内的方法！"+currentTab);
                        var tableName = currentTab+"Table";
                        var qsDate = collectQueryInfo(tableName);
                        //根据tabName初始化table
                        if(currentTab=="#queryApply"){
                            //获取查询参数
//                            window.console.log("当前tab选项为：全部");
                            tabContent = tableName;
                            table = queryApplyTable;
                        }else if(currentTab=="#pendingTaskList"){
                            //获取查询参数
//                            window.console.log("当前tab选项为：待处理");
                            tabContent = tableName;
                            table = pendingTaskListTable;
                        }else if(currentTab=="#rejectTaskList"){
                            //获取查询参数
//                            window.console.log("当前tab选项为：拒绝");
                            tabContent = tableName;
                            table = rejectTaskListTable;
                        }else if(currentTab=="#approvedTaskList"){
                            //获取查询参数
//                            window.console.log("当前tab选项为：同意");
                            tabContent = tableName;
                            table = approvedTaskListTable;
                        }
                        taskFetch(qsDate,tableName);
                    }
            );
            /**
             * 全选选中
             */
            $("input#queryApplyAllCheck").click(function(){
                if(this.checked){
                    $("#queryApplyTable tbody tr").each(function(){
                        if(!$(this).hasClass("checked")){
                            $(this).click();
                        }
                    })
                }else {
                    $('#queryApplyTable tbody tr').click();
                }
            });
            $("input#pendingTaskListAllCheck").click(function(){
                if(this.checked){
                    $("#pendingTaskListTable tbody tr").each(function(){
                        if(!$(this).hasClass("checked")){
                            $(this).click();
                        }
                    })
                }else {
                    $('#pendingTaskListTable tbody tr').click();
                }
            });
            /**
             * 多选选中和取消选中,同时选中第一个单元格单选框,并联动全选单选框
             */
            $('#queryApplyTable tbody').on('click', 'tr', function(event) {
                var allChecked = $('input[name=allChecked]')[0]; //关联全选单选框
                $($(this).children()[0]).children().each(function() {
                    if (this.type == "checkbox" && (!$(event.target).is(":checkbox") && $(":checkbox", this).trigger("click"))) {
                        if (!this.checked) {
                            this.checked = true;
                            addValue(this);
                            var selected = table.rows('.selected').data().length; //被选中的行数
                            //全选单选框的状态处理
                            var recordsDisplay = table.page.info().recordsDisplay; //搜索条件过滤后的总行数
                            var iDisplayStart = table.page.info().start; // 起始行数
                            if (selected === table.page.len() || selected === recordsDisplay || selected === (recordsDisplay - iDisplayStart)) {
                                allChecked.checked = true;
                            }
                        } else {
                            this.checked = false;
                            cancelValue(this);
                            allChecked.checked = false;
                        }
                    }
                });
                $(this).toggleClass('selected'); //放在最后处理，以便给checkbox做检测
            });
            $('#pendingTaskListTable tbody').on('click', 'tr', function(event) {
                var allChecked = $('input[name=allChecked]')[0]; //关联全选单选框
                $($(this).children()[0]).children().each(function() {
                    if (this.type == "checkbox" && (!$(event.target).is(":checkbox") && $(":checkbox", this).trigger("click"))) {
                        if (!this.checked) {
                            this.checked = true;
                            addValue(this);
                            var selected = table.rows('.selected').data().length; //被选中的行数
                            //全选单选框的状态处理
                            var recordsDisplay = table.page.info().recordsDisplay; //搜索条件过滤后的总行数
                            var iDisplayStart = table.page.info().start; // 起始行数
                            if (selected === table.page.len() || selected === recordsDisplay || selected === (recordsDisplay - iDisplayStart)) {
                                allChecked.checked = true;
                            }
                        } else {
                            this.checked = false;
                            cancelValue(this);
                            allChecked.checked = false;
                        }
                    }
                });
                $(this).toggleClass('selected'); //放在最后处理，以便给checkbox做检测
            });
            /**
             * 单选框被选中时将它的value放入隐藏域
             */
            function addValue(para) {
                var userIds = $("input[name=id]");
                if (userIds.val() === "") {
                    userIds.val($(para).val());
                } else {
                    userIds.val(userIds.val() + "," + $(para).val());
                }
            };
            /**
             * 单选框取消选中时将它的value移除隐藏域
             */
            function cancelValue(para) {
                //取消选中checkbox要做的操作
                var userIds = $("input[name=allChecked]");
                var array = userIds.val().split(",");
                userIds.val("");
                for (var i = 0; i < array.length; i++) {
                    if (array[i] === $(para).val()) {
                        continue;
                    }
                    if (userIds.val() === "") {
                        userIds.val(array[i]);
                    } else {
                        userIds.val(userIds.val() + "," + array[i]);
                    }
                }
            };
            /**
             * 单击编辑窗口同意/拒绝按钮
             */
            $('.edit_submit').click(function(event)
            {

                //获取提交类型
                //获取公共字段
                var operatorName=userInfo.username;
                var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&collectionName=organizationInfo&originalID="+originalID;
                var updateInfo = "";
                var commitType = this.id;

                var applyCompanyID=$("#edit_applyCompanyID").val();
                var applyCompany=$("#edit_applyCompany").val();
                var applyPersonID=$("#edit_applyPersonID").val();
                var applyPerson=$("#edit_applyPerson").val();
                var applyTime=$("#edit_applyTime").val();
                var applyContent=$("#edit_applyContent").val();
                var approveCompanyID=$("#edit_approveCompanyID").val();
                var approveCompany=$("#edit_approveCompany").val();
                var approvePersonID=$("#edit_approvePersonID").val();
                var approvePerson=$("#edit_approvePerson").val();
                var approveTime=$("#edit_approveTime").val();
                var approveResult=$("#edit_approveResult").val();






                if(applyPersonID==""||applyPersonID==null)
                {

                    alert("申请人编号不能为空，请重新填写！")
                    $("#edit_applyPersonID").focus();
                    return;

                }else
                {
                    updateInfo+="&applyPersonID="+applyPersonID;
                }









                if(applyPerson==""||applyPerson==null)
                {

                    alert("申请人不能为空，请重新填写！")
                    $("#edit_applyPerson").focus();
                    return;

                }else
                {
                    updateInfo+="&applyPerson="+applyPerson;
                }


                if(applyTime==""||applyTime==null)
                {
                    alert("申请时间不能为空，请重新填写！")
                    $("#edit_applyTime").focus();
                    return;
                }else
                {
                    var applyTimeStamp = Date.parse(new Date(applyTime));
                    applyTimeStamp = applyTimeStamp / 1000;
                    updateInfo+="&applyTime="+applyTimeStamp;
                }

                if(applyContent==""||applyContent==null)
                {
                    alert("申请人内容不能为空，请重新填写！")
                    $("#edit_applyContent").focus();
                    return;
                }else
                {
                    updateInfo+="&applyContent="+applyContent;
                }

                if(approvePersonID==""||approvePersonID==null)
                {
                    alert("审批人编号不能为空，请重新填写！")
                    $("#edit_approvePersonID").focus();
                    return;
                }else
                {
                    updateInfo+="&approvePersonID="+approvePersonID;
                }

                if(approvePerson==""||approvePerson==null)
                {
                    alert("审批人不能为空，请重新填写！")
                    $("#edit_approvePerson").focus();
                    return;
                }else
                {
                    updateInfo+="&approvePerson="+approvePerson;
                }









                if(isUpdate==1)
                {
                    if(approveTime==""||approveTime==null)
                    {
                        alert("审批人时间不能为空，请重新填写！")
                        $("#edit_approveTime").focus();
                        return;
                    }else
                    {
                        var approveTimeStamp = Date.parse(new Date(approveTime));
                        approveTimeStamp = approveTimeStamp / 1000;

                        if(approveTimeStamp<=applyTimeStamp)
                        {
                            alert("审批时间不能早于申请时间，请重新填写！")
                            $("#add_taskEndTime").focus();
                            return;
                        }
                        else {
                            updateInfo += "&approveTime=" + approveTimeStamp;
                        }
                    }


                    updateInfo += "&approveResult=" + approveResult;
                    isUpdate=0;
                }
                else {
                    if (commitType == "submit_editOrganization") {
                        var approveTime = Date.parse(new Date());
                        approveTime = approveTime / 1000;
                        updateInfo += "&approveTime=" + approveTime;


                        //提交“同意”状态
                        updateInfo += "&approveResult=同意";


                    } else if (commitType == "reject_editOrganization") {
                        var approveTime = Date.parse(new Date());
                        approveTime = approveTime / 1000;
                        updateInfo += "&approveTime=" + approveTime;


                        //提交“拒绝”状态
                        updateInfo += "&approveResult=拒绝";
                    }
                }

                //收集编辑框字段

                qsData=qsData+updateInfo;
//                alert("编辑的提交数据为："+qsData);
                console.log("编辑的提交数据为："+qsData);
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/updateAll",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);

                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            };

                            return;
                        }else if (infoJson.success)
                        {
                            var sucInfo =  infoJson.success;
                            var msg = sucInfo.msg;
                            alert(msg);
                            $(".popBox[title=oneOrganizationInfo] input").val("");
                            $(".popBox[title=oneOrganizationInfo] textarea").val("");
                            $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").hide();

                            var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken+"&collectionName=organizationInfo";
                            //获取数据并加载
                            taskFetch(qsData,"#queryApplyTable")

                        }else {
                            alert("未知错误，请联系管理员！")
                        }


                    },
                    error: function (result) {
//                        console.log(result);
                        alert("无法连接到服务器！");
                    }
                });

            });
        });
    </script>
    <script type="text/javascript">
        var userInfo=JSON.parse(localStorage.getItem("userInfo"));
        var regionInfo=JSON.parse(localStorage.getItem("regionInfo"));
        var permissions=JSON.parse(localStorage.getItem("permissions"));
        var accessToken=localStorage.getItem("accessToken");
        var tokenEndTime=localStorage.getItem("tokenEndTime");
        //检查是否有登录状态
        function  checkUserValidity(){
            if(userInfo==null||accessToken==null) //访问的信息不存在，则返回空
            {
                alert("你还没有登录!");
                window.location.href = "login.html";
            }
            else {

                if (new Date().getTime()> tokenEndTime * 1000 )
                {
                    alert("登录授权时间超出!");
                    window.location.href = "login.html";

                }
                else
                {
//						alert(tokenEndTime * 1000+" "+new Date().getTime()+"已经登录成功了！"+userInfo);
                    var userType=userInfo.userType;
                    switch(userType[2])
                    {
                        case "3":  //用户为工程师，用户不能登录前端页面
                            alert("工程师不能登录前端!");
                            window.location.href = "login.html";
                            break;

                        case "2": //审批员只显示作业管理
                            $("#jizhanguanli").css('display','none');
                            $("#dianziyaoshiguanli").css('display','none');
                            $("#yuangongguanli").css('display','none');
                            break;

                        case "1": //管理员分五种情况
                            switch(userType[0])
                            {
                                case "1": //铁塔公司的管理员可以管理所有公司的员工

                                    break;
                                case "2": //运营商管理员可以管理除了铁塔公司外的所有员工
                                    $("#ttyg").css('display','none'); //隐藏铁塔公司员工管理界面
                                    break;
                                case "3":  //施工公司管理员只能管理自己属于的施工公司
                                    $("#ttyg").css('display','none'); //隐藏铁塔公司员工管理界面
                                    $("#yysyg").css('display','none'); //隐藏运营商公司员工管理界面
                                    $("#dwgsyg").css('display','none'); //隐藏代维公司员工管理界面
                                    $("#csyg").css('display','none'); //隐藏厂商公司员工管理界面
                                    $("#jizhanguanli").css('display','none'); //不能显示基站管理
                                    $("#dianziyaoshiguanli").css('display','none'); //不能显示钥匙管理


                                    break;
                                case "4": //代维公司管理员只能管理自己属于的代维公司
                                    $("#ttyg").css('display','none'); //隐藏铁塔公司员工管理界面
                                    $("#yysyg").css('display','none'); //隐藏运营商公司员工管理界面
                                    $("#sggsyg").css('display','none'); //隐藏施工公司员工管理界面
                                    $("#csyg").css('display','none'); //隐藏厂商公司员工管理界面

                                    $("#userType401").css('display','none'); //代维公司管理员不能自己添加管理员，隐藏管理员新增按钮
                                    $("#company_name").css('display','none'); //代维公司管理员只能管理自己所属代维公司，所以不需要显示公司名
                                    $("#staff_location").css('display','none'); //代维公司管理员只能管理自己所属代维公司，所以不需要显示公司地区
                                    $("#authority").css('display','none'); //代维公司管理员只能授予开门权限，其他权限的新增按钮要隐藏
                                    $("#jizhanguanli").css('display','none'); //不能显示基站管理
                                    $("#dianziyaoshiguanli").css('display','none'); //不能显示钥匙管理
                                    break;
                                case "5": //厂商公司管理员只能管理自己属于的厂商公司
                                    $("#ttyg").css('display','none'); //隐藏铁塔公司员工管理界面
                                    $("#yysyg").css('display','none'); //隐藏运营商公司员工管理界面
                                    $("#sggsyg").css('display','none'); //隐藏施工公司员工管理界面
                                    $("#dwgsyg").css('display','none'); //隐藏代维公司员工管理界面
                                    $("#jizhanguanli").css('display','none'); //不能显示基站管理
                                    $("#dianziyaoshiguanli").css('display','none'); //不能显示钥匙管理
                                    break;
                            }





                            break;
                    }

						showUserInformation(); //侧边栏显示当前用户公司 管理区域 职位 用户名
                }
                //动态的显示登录人员名字
//                document.getElementById("username").innerHTML=userInfo.username;
                document.getElementById("username1").innerHTML="欢迎回来"+" "+userInfo.username;

            }

            var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken+"&collectionName=organizationInfo";
            //获取数据并加载
            taskFetch(qsData,"#queryApplyTable")
        };
        //退出登录状态
        function  logout(){
            if(window.confirm("确定要退出登录状态？")){
                localStorage.clear();//清理登陆状态信息
                window.location.href="login.html";
            }
        };
        //重置按钮功能
        function resetNoArgs()
        {
            var tableName = tabContent;
            reset(tableName);
        }
        function reset(tableName)
        {
            if(tableName=="#queryApplyTable"){
                //对参数进行重置
                $("#query_applyStartTime").val("");
                $("#query_applyEndTime").val("");
                $("#query_approveResult").val("");


            }
            else if(tableName=="#pendingTaskListTable"){
                //对参数进行重置
                $("#query_taskStartTime_pending").val("");
                $("#query_taskEndTime_pending").val("");
                $("#query_applicantName_pending").val("");
            }else if(tableName=="#rejectTaskListTable"){
                //对参数进行重置
                $("#query_taskStartTime_reject").val("");
                $("#query_taskEndTime_reject").val("");
                $("#query_applicantName_reject").val("");
            }else if(tableName=="#approvedTaskListTable"){
                //对参数进行重置
                $("#query_taskStartTime_approved").val("");
                $("#query_taskEndTime_approved").val("");
                $("#query_applicantName_approved").val("");
            }
        }
        //导出xls文件
        function  exportXls(){
            var qsData = collectQueryInfo(tabContent);
//            window.console.log("导出excel的条件为："+qsData);
            //发起请求
            $.ajax({
                async: false,
                url: "https://www.smartlock.top/v0/downloadTask",
                type: "POST",
                contentType: "application/x-www-form-urlencoded",
                data: qsData,
                timeout: 8000,
                beforeSend: function ()
                {

                },
                success: function (result) {

                    //将返回数据转化为json格式数据
                    var infoJson =JSON.parse(result);

                    //判断查询是否成功
                    if (infoJson.error){
                        var errInfo = infoJson.error;
                        reset(tableName);
                        alert(errInfo.msg);
                        if(errInfo.code=="00000"){
                            window.location.href="login.html";
                        };
                        return;
                    }else if (infoJson.success)
                    {
                        alert("后台已经生成数据，请进行下载！");
                        reset(tableName);
                        var sucInfo =  infoJson.success;
                        var downloadUrl = sucInfo.url;
                        window.open(downloadUrl);
                    }else {
                        alert("未知错误，请联系管理员！")
                    }
                },
                error: function (result) {
//                    console.log(result);
                    alert("无法连接到服务器！");
                }
            });
        }
        //查询工单按钮
        function  queryTask()
        {
            var qsDate = collectQueryInfo(tabContent);
            taskFetch(qsDate,tabContent);
        }







        //获取工单列表
        function taskFetch(qsDataStr,tableName){
            var qsData = qsDataStr;

            console.log(qsData);
            //发起请求
            $.ajax({
                async: false,
                url: "https://www.smartlock.top/v0/queryAll",
                type: "POST",
                contentType: "application/x-www-form-urlencoded",
                data: qsData,
                timeout: 8000,
                beforeSend: function ()
                {
                },
                success: function (result) {
                    //将返回数据转化为json格式数据
                    var infoJson =JSON.parse(result);

                    //判断查询是否成功
                    if (infoJson.error){
                        var errInfo = infoJson.error;
                        reset(tableName);
                        $(""+tableName+"").dataTable().fnClearTable();//清除表格内原有的数据

                        if(errInfo.code=="18001")
                        {
                            return;
                        };

                        alert(errInfo.msg);
                        if(errInfo.code=="00000")
                        {
                            window.location.href="login.html";
                        };

                        return;
                    }
                    else if (infoJson.success)
                    {
                        var sucInfo =  infoJson.success;
//                        console.log(sucInfo);
                        reset(tableName);
                        $(""+tableName+"").dataTable().fnClearTable();//清除表格内原有的数据
                        $(""+tableName+"").dataTable().fnAddData(sucInfo,true);
                    }else {
                        alert("未知错误，请联系管理员！")
                    }

                },
                error: function (result) {
//                    console.log(result);
                    alert("无法连接到服务器！");
                }
            });
        };

        //封装参数校验和转换
        function checkArgs(querylStartTime,queryEndTime,approveResult){
            var qsDataActive="";
            if(querylStartTime!=""&&querylStartTime!=null){
                var starTimer = new Date(Date.parse(querylStartTime.replace(/-/g, "/")));
//                window.console.log("开始时间戳为："+starTimer.getTime());
                qsDataActive = "&applyStartTime="+starTimer.getTime().toString().substring(0,10)
            };
            if(queryEndTime!=""&&queryEndTime!=null){
                var endTimer = new Date(Date.parse(queryEndTime.replace(/-/g, "/")));
//                window.console.log("结束时间戳为："+endTimer.getTime());
                qsDataActive +="&applyEndTime="+endTimer.getTime().toString().substring(0,10)
            };
            if(approveResult!=""&&approveResult!=null){
                qsDataActive +="&approveResult="+approveResult;
            }
            return qsDataActive;
        }

        //根据页面不同获取查询参数
        function collectQueryInfo(tabName)
        {
            //获取固定参数
            var operatorName=userInfo.username;
            var qsData="operatorName="+operatorName+"&accessToken="+accessToken+"&collectionName=organizationInfo";
            var qsDataActive="";
            var applyStartTime = "";
            var applyEndTime= "";
            var approveResult="";

            //对动态参数进行判断
            if(tabName=="#queryApplyTable")
            {
//                window.console.log("当前tab选项为：全部");
                //获取查询参数
                applyStartTime = $("#query_applyStartTime").val();
                applyEndTime = $("#query_applyEndTime").val();
                approveResult = $("#query_approveResult").val();

                //对参数进行判空和处理
                qsDataActive = checkArgs(applyStartTime,applyEndTime,approveResult);

            }
            else if(tabName=="#pendingTaskListTable"){
//                window.console.log("当前tab选项为：待处理");
                //获取查询参数
                taskStartTime = $("#query_taskStartTime_pending").val();
                taskEndTime = $("#query_taskEndTime_pending").val();
                applicantName = $("#query_applicantName_pending").val();
                //对参数进行判空和处理
                qsDataActive +="&applicationStatus=pending";
                qsDataActive += checkArgs(taskStartTime,taskEndTime,applicantName);
            }else if(tabName=="#rejectTaskListTable"){
//                window.console.log("当前tab选项为：拒绝");
                //获取查询参数
                taskStartTime = $("#query_taskStartTime_reject").val();
                taskEndTime = $("#query_taskEndTime_reject").val();
                applicantName = $("#query_applicantName_reject").val();
                //对参数进行判空和处理
                qsDataActive+="&applicationStatus=reject";
                qsDataActive += checkArgs(taskStartTime,taskEndTime,applicantName);
            }else if(tabName=="#approvedTaskListTable"){
//                window.console.log("当前tab选项为：同意");
                //获取查询参数
                taskStartTime = $("#query_taskStartTime_approved").val();
                taskEndTime = $("#query_taskEndTime_approved").val();
                applicantName = $("#query_applicantName_approved").val();
                //对参数进行判空和处理
                qsDataActive+="&applicationStatus=approve"
                qsDataActive += checkArgs(taskStartTime,taskEndTime,applicantName);
            }
            if (qsDataActive==""||qsDataActive==null){
                return qsData
            }else{
                return qsData+qsDataActive;
            }
        }











        function showUserInformation() //侧边栏显示当前用户公司 管理区域 职位 用户名
        {
            var userType=userInfo.userType;

            switch(userType)
            {
                case "101":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司省级管理员<br>"+userInfo.username;
                    break;
                case "111":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司市级管理员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "121":
                    document.getElementById("loginuser").innerHTML="<br>铁塔公司区县管理员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;
                case "201":
                    document.getElementById("loginuser").innerHTML="<br>运营商省级管理员<br>"+userInfo.username;
                    break;
                case "211":
                    document.getElementById("loginuser").innerHTML="<br>运营商市级管理员<br>"+regionInfo.managementCity+" <br>"+userInfo.username;
                    break;
                case "221":
                    document.getElementById("loginuser").innerHTML="<br>运营商区县管理员<br>"+regionInfo.managementCity+" "+regionInfo.managementArea+" <br>"+userInfo.username;
                    break;
                case "301":
                    document.getElementById("loginuser").innerHTML="<br>施工公司管理员<br>"+userInfo.username;
                    break;
                case "302":
                    document.getElementById("loginuser").innerHTML="<br>施工公司审批员<br>"+userInfo.username;
                    break;
                case "401":
                    document.getElementById("loginuser").innerHTML="<br>代维公司管理员<br>"+userInfo.username;
                    break;
                case "402":
                    document.getElementById("loginuser").innerHTML="<br>代维公司审批员<br>"+userInfo.username;
                    break;
                case "501":
                    document.getElementById("loginuser").innerHTML="<br>厂商管理员<br>"+userInfo.username;
                    break;
                case "502":
                    document.getElementById("loginuser").innerHTML="<br>厂商审批员<br>"+userInfo.username;
                    break;

            }

        }














        /**
         * addOneTask事件设置
         */
        $(document).ready(function()
        {
//            $(".popBox[title=addOneTask] input").val("");
//            $(".model-bg[title=addOneTask],.popBox[title=addOneTask]").hide();

            $("#cancel_addOneTask").click(function(event)
            {
                $(".popBox[title=addOneTask] input").val("");
                $(".model-bg[title=addOneTask],.popBox[title=addOneTask]").hide();
            });

            $(".clsBtn[title=addOneTask]").click(function(event)
            {
                $(".model-bg[title=addOneTask],.popBox[title=addOneTask]").hide();
            });


            /**
             * 点击增加按钮
             */
//        $("#queryApplyAdd").click(function()
            $(".button[id=queryApplyAdd]").click(function()
            {

                //显示编辑窗口
                $(".model-bg[title=addOneTask],.popBox[title=addOneTask]").show();

            });

            /**
             * 单击编辑窗口提交按钮
             */
            $('#submit_addOneTask').click(function(event)
            {












                alert("进入提交动作！");
                //获取公共字段
                var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken; //+"&collectionName=taskInfo";
                var updateInfo = "";
                //收集编辑框字段





                var stationAddress=$("#add_stationAddress").val();
                var applicantName=userInfo.realname;
                var applicantCompany=userInfo.company;
                var applicantPhone=userInfo.phone;
                var applicantKeyID=$("#add_applicantKeyID").val();
                var applicationType=$("#add_applicationType").val();
                var applyDescription=$("#add_applyDescription").val();
                var taskStartTime=$("#add_taskStartTime").val();
                var taskEndTime=$("#add_taskEndTime").val();
                var taskTimes=$("#add_taskTimes").val();
                var applyType=$("#add_applyType").val();
















                //对字段进行判空
                if(stationAddress==""||stationAddress==null)
                {
                    alert("基站地址不能为空，请重新填写！")
                    $("#add_stationAddress").focus();
                    return;
                }else
                {
                    updateInfo+="&stationAddress="+stationAddress;
                }

                updateInfo +="&applicantName="+applicantName;
                updateInfo +="&applicantCompany="+applicantCompany;
                updateInfo +="&applicantPhone="+applicantPhone;

                if(applicantKeyID==""||applicantKeyID==null)
                {
                    alert("锁ID不能为空，请重新填写！")
                    $("#add_applicantKeyID").focus();
                    return;
                }else{
                    updateInfo+="&applicantKeyID="+applicantKeyID;
                }

                updateInfo +="&applicationType="+applicationType;

                if(applyDescription==""||applyDescription==null)
                {
                    alert("申请描述不能为空，请重新填写！")
                    $("#add_applyDescription").focus();
                    return;
                }else
                {
                    updateInfo+="&applyDescription="+applyDescription;
                }

                if(taskStartTime==""||taskStartTime==null)
                {
                    alert("开门的起始时间不能为空，请重新填写！")
                    $("#add_taskStartTime").focus();
                    return;
                }else
                {
                    var taskStartTimeStamp = Date.parse(new Date(taskStartTime));
                    taskStartTimeStamp = taskStartTimeStamp / 1000;
                    updateInfo+="&taskStartTime="+taskStartTimeStamp;
                }

                if(taskEndTime==""||taskEndTime==null)
                {
                    alert("开门的结束时间不能为空，请重新填写！")
                    $("#add_taskEndTime").focus();
                    return;
                }else
                {
                    var taskEndTimeStamp = Date.parse(new Date(taskEndTime));
                    taskEndTimeStamp = taskEndTimeStamp / 1000;

                    if(taskEndTimeStamp<=taskStartTimeStamp)
                    {
                        alert("结束时间不能早于开始时间，请重新填写！")
                        $("#add_taskEndTime").focus();
                        return;
                    }
                    else {

                        updateInfo += "&taskEndTime=" + taskEndTimeStamp;
                    }
                }










                updateInfo +="&taskTimes="+taskTimes;
                updateInfo +="&applyType="+applyType;


                qsData=qsData+updateInfo;
//                alert("编辑的提交数据为："+qsData);
                console.log("编辑的提交数据为："+qsData);
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/taskRequest",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);

                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            };
                            return;
                        }else if (infoJson.success)
                        {

                            var sucInfo =  infoJson.success;
                            var msg = sucInfo.msg;
                            alert(msg);
                            $(".popBox[title=addOneTask] input").val("");
                            $(".model-bg[title=addOneTask],.popBox[title=addOneTask]").hide();


                            var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken;
                            //获取数据并加载
                            taskFetch(qsData,"#queryApplyTable")

                        }else
                        {
                            alert("未知错误，请联系管理员！")
                        }


                    },
                    error: function (result)
                    {
//                        console.log(result);
                        alert("无法连接到服务器！");

                    }
                });

            });

        });


        /**
         * updateOneTask事件设置
         */
        $(document).ready(function()
        {
//            $(".popBox[title=addOneTask] input").val("");
//            $(".model-bg[title=addOneTask],.popBox[title=addOneTask]").hide();

            $("#cancel_updateOneTask").click(function(event)
            {

                $(".popBox[title=updateOneTask] input").val("");
                $(".model-bg[title=updateOneTask],.popBox[title=updateOneTask]").hide();

            });

            $(".clsBtn[title=updateOneTask]").click(function(event)
            {

                $(".model-bg[title=updateOneTask],.popBox[title=updateOneTask]").hide();

            });


            /**
             * 点击修改按钮
             */
//        $("#queryApplyAdd").click(function()
            $(".button[id=queryApplyUpdate]").click(function()
            {
                var theArray = [];
                var a = table.rows('.selected').data();

                for(var i=0;i< a.length;i++)
                {

                    var _id = a[i]._id;
                    theArray.push(_id)

                };
//                console.log(theArray.toString());
                if(theArray.length!=1)
                {

                    alert("只能选择一行记录进行修改!")
                    return;

                }else
                {

//                    alert("所选中的数据为：" + theArray.toString())

                    originalID = a[0]._id;
                    originalUserType = a[0].userType;
                    originalCompanyID = a[0].companyID;
                    isUpdate=1;

                    $("#edit_applyCompanyID").val(a[0].applyCompanyID);
                    $("#edit_applyCompany").val(a[0].applyCompany);
                    $("#edit_applyPersonID").val(a[0].applyPersonID);
                    $("#edit_applyPerson").val(a[0].applyPerson);
                    $("#edit_applyTime").val( new Date(parseInt(a[0].applyTime) * 1000).format('yyyy/MM/dd h:m:s') );
                    $("#edit_applyContent").val(a[0].applyContent);
                    $("#edit_approveCompanyID").val(a[0].approveCompanyID);
                    $("#edit_approveCompany").val(a[0].approveCompany);
                    $("#edit_approvePersonID").val(a[0].approvePersonID);
                    $("#edit_approvePerson").val(a[0].approvePerson);
                    $("#edit_approveTime").val( new Date(parseInt(a[0].approveTime) * 1000).format('yyyy/MM/dd h:m:s') );

                    if(a[0].approveResult=="审核中")
                    {
                        $("#edit_approveResult").get(0).selectedIndex = 0;
                    }
                    else if(a[0].approveResult=="拒绝")
                    {
                        $("#edit_approveResult").get(0).selectedIndex = 1;

                    }
                    else if(a[0].approveResult=="同意")
                    {
                        $("#edit_approveResult").get(0).selectedIndex = 2;

                    }






                    //显示编辑窗口
                    $("#edit_applyCompanyID").attr("disabled",true);
                    $("#edit_applyCompany").attr("disabled",true);
                    $("#edit_applyPersonID").attr("disabled",false);
                    $("#edit_applyPerson").attr("disabled",false);
                    $("#edit_applyTime").attr("disabled",false);
                    $("#edit_applyContent").attr("disabled",false);
                    $("#edit_approveCompanyID").attr("disabled",true);
                    $("#edit_approveCompany").attr("disabled",true);
                    $("#edit_approvePersonID").attr("disabled",false);
                    $("#edit_approvePerson").attr("disabled",false);
                    $("#edit_approveTime").attr("disabled",false);
                    $("#edit_approveResult").attr("disabled",false);


                    $("#submit_editOrganization").show();
                    $("#reject_editOrganization").hide();

                    $(".model-bg[title=oneOrganizationInfo],.popBox[title=oneOrganizationInfo]").show();
                }

            });

            /**
             * 单击编辑窗口提交按钮
             */
            $('#submit_updateOneTask').click(function(event)
            {

                alert("进入提交动作！");
                //获取公共字段
                var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken+"&collectionName=taskInfo&originalID="+originalID;
                var updateInfo = "";
                //收集编辑框字段





                var applicationType=$("#update_applicationType").val();
                var applyDescription=$("#update_applyDescription").val();
                var taskStartTime=$("#update_taskStartTime").val();
                var taskEndTime=$("#update_taskEndTime").val();
                var taskTimes=$("#update_taskTimes").val();
                var applyType=$("#update_applyType").val();


                updateInfo +="&applicationType="+applicationType;

                if(applyDescription==""||applyDescription==null)
                {
                    alert("申请描述不能为空，请重新填写！")
                    $("#update_applyDescription").focus();
                    return;
                }else
                {
                    updateInfo+="&applyDescription="+applyDescription;
                }

                if(taskStartTime==""||taskStartTime==null)
                {
                    alert("开门的起始时间不能为空，请重新填写！")
                    $("#update_taskStartTime").focus();
                    return;
                }else
                {
                    var taskStartTimeStamp = Date.parse(new Date(taskStartTime));
                    taskStartTimeStamp = taskStartTimeStamp / 1000;
                    updateInfo+="&taskStartTime="+taskStartTimeStamp;
                }

                if(taskEndTime==""||taskEndTime==null)
                {
                    alert("开门的结束时间不能为空，请重新填写！")
                    $("#update_taskEndTime").focus();
                    return;
                }else
                {
                    var taskEndTimeStamp = Date.parse(new Date(taskEndTime));
                    taskEndTimeStamp = taskEndTimeStamp / 1000;

                    if(taskEndTimeStamp<=taskStartTimeStamp)
                    {
                        alert("结束时间不能早于开始时间，请重新填写！")
                        $("#update_taskEndTime").focus();
                        return;
                    }
                    else {

                        updateInfo += "&taskEndTime=" + taskEndTimeStamp;
                    }
                }










                updateInfo +="&taskTimes="+taskTimes;
                updateInfo +="&applyType="+applyType;


                qsData=qsData+updateInfo;
//                alert("编辑的提交数据为："+qsData);
                console.log("编辑的提交数据为："+qsData);
                //发起请求
                $.ajax({
                    async: false,
                    url: "https://www.smartlock.top/v0/updateAll",
                    type: "POST",
                    contentType: "application/x-www-form-urlencoded",
                    data: qsData,
                    timeout: 8000,
                    beforeSend: function ()
                    {

                    },
                    success: function (result) {

                        //将返回数据转化为json格式数据
                        var infoJson =JSON.parse(result);

                        //判断查询是否成功
                        if (infoJson.error){
                            var errInfo = infoJson.error;
                            alert(errInfo.msg);
                            if(errInfo.code=="00000"){
                                window.location.href="login.html";
                            };
                            return;
                        }else if (infoJson.success)
                        {
                            var sucInfo =  infoJson.success;
                            var msg = sucInfo.msg;
                            alert(msg);
                            $(".popBox[title=updateOneTask] input").val("");
                            $(".model-bg[title=updateOneTask],.popBox[title=updateOneTask]").hide();


                            var qsData="operatorName="+userInfo.username+"&accessToken="+accessToken;
                            //获取数据并加载
                            taskFetch(qsData,"#queryApplyTable")
                        }else {
                            alert("未知错误，请联系管理员！")
                        }


                    },
                    error: function (result) {
//                        console.log(result);
                        alert("无法连接到服务器！");
                    }
                });

            });

        });




    </script>
</head>


<body onload=checkUserValidity()>
<div id="body-wrapper"> <!-- Wrapper for the radial gradient background -->
    <div id="sidebar"><div id="sidebar-wrapper"> <!-- Sidebar with logo and menu -->
        <!--<h1 id="sidebar-title"><a href="#">SimpleAdmin</a></h1>-->
        <!-- Logo (221px wide) -->
        <a href="#"><img id="logo" src="../assets/images/logo.png" alt="Simpla Admin logo" /></a>

        <!-- Sidebar Profile links -->
        <div id="profile-links">
            你好, <a href="#" title="Edit your profile" id="loginuser" class="loginuser" > </a><br />
            <br />
            <a href="#" class="mode2" title="View the Site">修改资料</a> | <a href="#" title="Sign Out" onclick="logout()">退出</a>
        </div>
        <ul id="main-nav">  <!-- Accordion Menu -->
            <li>
                <a href="main.html" class="nav-top-item no-submenu"> <!-- Add the class "no-submenu" to menu items with no sub menu -->
                    首页
                </a>
            </li>

            <div id="jizhanguanli">
                <li>
                    <a href="#" class="nav-top-item"> <!-- Add the class "current" to current menu item -->
                        基站管理
                    </a>
                    <ul>
                        <li><a  href="stationManage.html">基站列表</a></li> <!-- Add class "current" to sub menu items also -->
                        <li><a  href="stationManageLog.html">基站日志管理</a></li>
                    </ul>
                </li>
            </div>

            <li>
                <a href="#" class="nav-top-item">
                    工单管理
                </a>
                <ul>
                    <li><a  href="taskManage.html">工单列表</a></li>
                    <li><a  href="abnormalTaskManage.html">异常工单</a></li>
                </ul>
            </li>

            <div id="dianziyaoshiguanli">
                <li>
                    <a href="#" class="nav-top-item">
                        钥匙管理
                    </a>
                    <ul>
                        <li><a href="keyManage.html">钥匙列表</a></li>
                        <li><a href="keyManageLog.html">钥匙日志</a></li>
                    </ul>
                </li>
            </div>

            <li>
                <a href="#" class="nav-top-item current">
                    机构管理
                </a>
                <ul>
                    <li><a class="current" href="organizationManage.html">机构管理</a></li>

                </ul>
            </li>

            <div id="yuangongguanli">
                <li>
                    <a href="tower_manager_main.html" class="nav-top-item ">
                        员工管理
                    </a>
                    <ul>
                        <div id="ttyg"> <li><a href="tower_manager_main.html">铁塔公司员工管理</a></li> </div>
                        <div id="yysyg"> <li><a href="service_manager_main.html">运营商员工管理</a></li> </div>
                        <div id="sggsyg"> <li><a href="construction_manager_main.html">施工公司员工管理</a></li> </div>
                        <div id="dwgsyg"> <li><a href="agent_manager_main.html">代维公司员工管理</a></li> </div>
                        <div id="csyg"> <li><a href="manufacturer_manager_main.html" >厂商商员工管理</a></li> </div>
                    </ul>
                </li>
            </div>
        </ul> <!-- End #main-nav -->
    </div></div> <!-- End #sidebar -->

    <div id="main-content"> <!-- Main Content Section with everything -->

        <!-- Page Head -->
        <h2 id="username1"> </h2>

        <p id="page-intro">What would you like to do?</p>
        <div class="clear"></div> <!-- End .clear -->
        <div class="content-box"><!-- Start Content Box -->

            <div class="content-box-header">
                <!--<h3>内容模块</h3>-->
                <ul class="content-box-tabs">

                    <li><a href="#queryApply" class="default-tab" >机构审批</a></li> <!-- href must be unique and match the id of target div -->

                </ul>

                <div class="clear"></div>

            </div> <!-- End .content-box-header -->


            <!--弹出编辑框开始-->
            <div class="dialog">
                <div class="model-bg" title="oneOrganizationInfo"></div>
                <div class="popBox" title="oneOrganizationInfo">
                    <div class="ttBox">
                        <a class="clsBtn" title="oneOrganizationInfo"></a>
                        <span class="tt">工单详情</span>
                    </div>
                    <div class="txtBox">
                        <div class="item">
                            <label for="edit_applyCompanyID">申请公司编号：</label>
                            <input type="text" id="edit_applyCompanyID" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_applyCompany">申请公司名：</label>
                            <input type="text" id="edit_applyCompany" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_applyPersonID">申请人编号：</label>
                            <input type="text" id="edit_applyPersonID" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_applyPerson">申请人：</label>
                            <input type="text" id="edit_applyPerson" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_applyTime">申请时间：</label>
                            <input type="text" id="edit_applyTime" placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})" >
                        </div>
                        <div class="item">
                            <label for="edit_applyContent">申请内容：</label>
                            <input type="text" id="edit_applyContent" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_approveCompanyID">审批公司编号：</label>
                            <input type="text" id="edit_approveCompanyID" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_approveCompany">审批公司：</label>
                            <input type="text" id="edit_approveCompany" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_approvePersonID">审批人ID：</label>
                            <input type="text" id="edit_approvePersonID" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_approvePerson">审批人：</label>
                            <input type="text" id="edit_approvePerson" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="edit_approveTime">审批时间：</label>
                            <input type="text" id="edit_approveTime" placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
                        </div>
                        <div class="item">
                            <label for="edit_approveResult">审批结果：</label>

                            <select id="edit_approveResult" class="edit_select">
                                <option value="审核中" >审核中</option>
                                <option value="拒绝" >拒绝</option>
                                <option value="同意" >同意</option>
                            </select>



                        </div>
                        <!--<div class="item">-->
                            <!--<label for="edit_reason">审批说明：</label>-->
                            <!--<textarea id="edit_reason" rows="2" cols="18" style="resize: none"></textarea>-->
                        <!--</div>-->
                    </div>
                    <div class="btnArea">
                        <div class="btnGroup">
                            <a class="sgBtn ok edit_submit" id="submit_editOrganization">确定</a>
                            <a class="sgBtn reject edit_submit" id="reject_editOrganization">拒绝</a>
                            <a class="sgBtn cancel " id="cancel_eidtOrganization">取消</a>
                        </div>
                    </div>
                </div>
            </div>

            <!--新建工单弹出编辑框开始-->
            <div class="dialog">
                <div class="model-bg" title="addOneTask"></div>
                <div class="popBox" title="addOneTask">
                    <div class="ttBox">
                        <a class="clsBtn" title="addOneTask"></a>
                        <span class="tt">申请工单</span>
                    </div>
                    <div class="txtBox">
                        <div class="item">
                            <label for="add_stationAddress">基站地址：</label>
                            <input type="text" id="add_stationAddress" class="edit_text" >
                        </div>
                        <div class="item">
                            <label for="add_applicantKeyID">授权钥匙ID：</label>
                            <input type="text" id="add_applicantKeyID" class="edit_text">
                        </div>
                        <div class="item">
                            <label for="add_applicationType">任务紧急情况</label>
                            <select id="add_applicationType" class="edit_select" >
                                <option value="普通" >普通</option>
                                <option value="紧急" >紧急</option>
                            </select>
                        </div>
                        <div class="item">
                            <label for="add_applyDescription">申请描述：</label>
                            <input type="text" id="add_applyDescription" class="edit_text">
                            <!--<textarea rows="3" cols="20"  id="add_applyDescription" />-->
                        </div>
                        <div class="item">
                            <label for="add_taskTimes">申请开门次数：</label>
                            <select id="add_taskTimes" class="edit_select" >
                                <option value="1" >1</option>
                                <option value="2" >2</option>
                                <option value="3" >3</option>
                                <option value="4" >4</option>
                                <option value="5" >5</option>
                            </select>
                        </div>
                        <div class="item">
                            <label for="add_applyType">申请工单类型 ：</label>
                            <select id="add_applyType" class="edit_select">
                                <option value="app">app</option>
                                <option value="key">key</option>
                            </select>
                        </div>
                        <div class="item">
                            <label for="add_taskStartTime">开门开始时间：</label>
                            <input id="add_taskStartTime" type="text"  placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})"/>
                        </div>
                        <div class="item">
                            <label for="add_taskEndTime">开门结束时间:</label>
                            <input id="add_taskEndTime" type="text"  placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})"/>
                        </div>


                    </div>



                    <div class="btnArea">
                        <div class="btnGroup">
                            <a class="sgBtn ok" id="submit_addOneTask">确定</a>
                            <a class="sgBtn cancel" id="cancel_addOneTask">取消</a>
                        </div>
                    </div>
                </div>
            </div>
            <!--新建工单框结束-->

            <!--修改工单弹出编辑框开始-->
            <div class="dialog">
                <div class="model-bg" title="updateOneTask"></div>
                <div class="popBox" title="updateOneTask">
                    <div class="ttBox">
                        <a class="clsBtn" title="updateOneTask"></a>
                        <span class="tt">申请工单</span>
                    </div>
                    <div class="txtBox">
                        <div class="item">
                            <label for="update_applicantName">申请人：</label>
                            <input type="text" id="update_applicantName" class="edit_text" disabled="true">
                        </div>
                        <div class="item">
                            <label for="update_stationAddress">基站地址：</label>
                            <input type="text" id="update_stationAddress" class="edit_text" disabled="true">
                        </div>
                        <div class="item">
                            <label for="update_applicantKeyID">授权钥匙ID：</label>
                            <input type="text" id="update_applicantKeyID" class="edit_text" disabled="true">
                        </div>
                        <div class="item">
                            <label for="update_applicationType">任务紧急情况</label>
                            <select id="update_applicationType" class="edit_select" >
                                <option value="普通" >普通</option>
                                <option value="紧急" >紧急</option>
                            </select>
                        </div>
                        <div class="item">
                            <label for="update_applyDescription">申请描述：</label>
                            <input type="text" id="update_applyDescription" class="edit_text">
                            <!--<textarea rows="3" cols="20"  id="update_applyDescription" />-->
                        </div>
                        <div class="item">
                            <label for="update_taskTimes">申请开门次数：</label>
                            <select id="update_taskTimes" class="edit_select" >
                                <option value="1" >1</option>
                                <option value="2" >2</option>
                                <option value="3" >3</option>
                                <option value="4" >4</option>
                                <option value="5" >5</option>
                            </select>
                        </div>
                        <div class="item">
                            <label for="update_applyType">申请工单类型 ：</label>
                            <select id="update_applyType" class="edit_select">
                                <option value="app">app</option>
                                <option value="key">key</option>
                            </select>
                        </div>
                        <div class="item">
                            <label for="update_taskStartTime">开门开始时间：</label>
                            <input id="update_taskStartTime" type="text"  placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})"/>
                        </div>
                        <div class="item">
                            <label for="update_taskEndTime">开门结束时间:</label>
                            <input id="update_taskEndTime" type="text"  placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})"/>
                        </div>


                    </div>



                    <div class="btnArea">
                        <div class="btnGroup">
                            <a class="sgBtn ok" id="submit_updateOneTask">确定</a>
                            <a class="sgBtn cancel" id="cancel_updateOneTask">取消</a>
                        </div>
                    </div>
                </div>
            </div>
            <!--修改工单框结束-->

            <div class="dialog">
                <div class="model-bg" title="editPersonInfo"></div>
                <div class="popBox" title="editPersonInfo">
                    <div class="ttBox">
                        <a class="clsBtn" title="editPersonInfo"></a>
                        <span class="tt">修改个人信息</span>
                    </div>
                    <div class="txtBox">
                        <div class="item">
                            <label for="editPerson_username">用户名：</label>
                            <input type="text" id="editPerson_username" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_userType">用户类型：</label>
                            <input type="text" id="editPerson_userType" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_company">用户所属公司：</label>
                            <input type="text" id="editPerson_company" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_phone">手机号码：</label>
                            <input type="text" id="editPerson_phone" disabled="true">
                        </div>
                        <div class="item">
                            <label for="editPerson_originalPassword">原始密码：</label>
                            <input type="password" id="editPerson_originalPassword">
                        </div>
                        <div class="item">
                            <label for="editPerson_newPassword1">新密码：</label>
                            <input type="password" id="editPerson_newPassword1">
                        </div>
                        <div class="item">
                            <label for="editPerson_newPassword2">确认新密码：</label>
                            <input type="password" id="editPerson_newPassword2">
                        </div>
                    </div>
                    <div class="btnArea">
                        <div class="btnGroup">
                            <a class="sgBtn ok" id="submit_editPerson">确定</a>
                            <a class="sgBtn cancel" id="cancel_editPerson">取消</a>
                        </div>
                    </div>
                </div>
            </div><!-- End 修改个人资料 -->
            <!--弹出编辑框结束-->
            <div class="content-box-content">
                <div class="tab-content default-tab" id="queryApply"> 	<!-- This is the target div. id must match the href of this div's tab -->
                    <div class="queryCondition" id="queryApplyQueryCondition">
                        <div class="screen-top">
                            <span>申请开始时间&nbsp;&nbsp;&nbsp;&nbsp;<input id="query_applyStartTime" type="text" placeholder="请输入开始日期"  class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})"/></span>
                            <span>申请结束时间&nbsp;&nbsp;&nbsp;<input id="query_applyEndTime" type="text"  placeholder="请输入结束日期" class="laydate-icon" onClick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})"  /></span>
                            <span>申请结果
                                <select id="query_approveResult" class="query_select" >
                                    <option value="" ></option>
                                    <option value="审核中" >审核中</option>
                                    <option value="拒绝" >拒绝</option>
                                    <option value="同意" >同意</option>
                                </select>
                            </span>
                        </div>
                        <div class="screen-top">
                            <input class="button" id="queryApplyQuery" type="submit" value="查询" onclick="queryTask()" />
                            <input class="button" id="queryApplyReset" type="reset" value="重置" onclick="resetNoArgs()" />
                            <input class="button" id="queryApplyUpdate" type="reset" value="修改"  />
                            <input class="button" id="queryApplyZoneAuth" type="button" value="地区权限" />
                            <input class="button" id="queryApplyStationAuth" type="button" value="基站权限" />
                            <!--<input class="button" id="queryApplyExportxls" type="button" value="导出xls" onclick="exportXls()" />-->
                        </div>
                    </div>
                    <div>
                        <table class="display" id="queryApplyTable" cellspacing="0" width="100%">
                            <thead>
                            <tr>
                                <th><input type="checkbox" id="queryApplyAllCheck" name="allChecked" /></th>
                                <th>申请公司编号</th>
                                <th>申请公司名称</th>
                                <th>申请人编号</th>
                                <th>申请人名</th>
                                <th>申请时间</th>
                                <th>申请内容</th>
                                <th>审批公司编号</th>
                                <th>审批公司名称</th>
                                <th>审批人编号</th>
                                <th>审批人名称</th>
                                <th>审批时间</th>
                                <th>审批结果</th>
                                <th>操作</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div> <!-- End #queryApply -->


            </div> <!-- End .content-box-content -->

        </div> <!-- End .content-box -->

        <div id="footer">
            <small> <!-- Remove this notice or replace it with whatever you want -->
                &#169; Copyright 2016 四川九鼎数码科技有限公司 | Powered by UESTC CSIS</a> | <a href="#top">Top</a>
            </small>
        </div><!-- End #footer -->

    </div> <!-- End #main-content -->

</div>
</body>

</html>
